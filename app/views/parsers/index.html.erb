<h1>All parsed logs</h1>

<ol>
    <% @events.each do |event| %>
    <% event.data %>
    <%  @srcIP = event.data.match(/src=((\d{1,3}\.){3}\d{1,3})/)[1]  %>
    <%  @dstIP = event.data.match(/dst=((\d{1,3}\.){3}\d{1,3})/)[1]  %>
    <% @srcIP_validation_check = IPAddress.valid? @srcIP %> 
    <% @dstIP_validation_check = IPAddress.valid? @dstIP %> 

            
    <% if @srcIP_validation_check == false %>
        <% @srcIP_private_check = "Invalid IP" %> 
        <% ip2 = IPAddress @dstIP %>            
        <% @dstIP_private_check = ip2.private?   %>
    <% else %>
        <% ip = IPAddress @srcIP %>
        <% @srcIP_private_check = ip.private? %>
        <% ip2 = IPAddress @dstIP %>
        <% @dstIP_private_check = ip2.private? %>
    <% end   %>


    <ul>
    <li>Source IP : <%= @srcIP %></li>
    <li>Source IP is Valid : <%= IPAddress.valid? @srcIP %> </li>
    <li>Source IP is Private : <%= @srcIP_private_check %> </li>

    <li>Destination IP : <%= @dstIP %></li>
    <li>Destination IP is Valid : <%= IPAddress.valid? @dstIP %> </li>
    <li>Destination IP is Private : <%= @dstIP_private_check %> </li>


    
  <!--  <li>Destination IP : <%= event.data.match(/dst=((\d{1,3}\.){3}\d{1,3})/)[1] %></li>
    <li>Destination IP is Valid : <%= IPAddress.valid? event.data.match(/dst=((\d{1,3}\.){3}\d{1,3})/)[1] %></li> -->

    </ul><br/>
    <%end  %>
</ol>

<%= button_to 'Back',  events_path, method: :get %>





